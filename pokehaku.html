<!DOCTYPE html>
<html lang="fi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <!-- Bootstrap CSS linkki -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- JS linkki -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <title>JSON palautus</title>
  </head>

  <style>
    img {
      width: 100%;
    }
  </style>

  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-sm navbar-custom">
      <div class="container-fluid">
        <!-- Hamburger -->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#collapsibleNavbar"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="collapsibleNavbar">
          <!-- Links -->
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="./index.html">Etusivu</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./toteutus.html">Toteutus</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./pokehaku.html">Pokehaku</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./saa.html">Säätiedot</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Lisätään hakulaatikko ja paikka mihin Pokemonin kuva laitetaan -->
<h1>Pokemon haku</h1>
    <p>
      <input type="text" id="pokemonName" placeholder="Enter Pokemon name">
      <button onclick="poke()">Hae</button><br>
    
      <div id="nimi">Kirjoita laatikkoon Pokemonin nimi</div>
    <p id="omi1"></p>
    <p id="omi2"></p>
    <p id="omi3"></p>
    <p id="käännä-painike"></p>
    <p id="kuva2"></p>
    </p>



    <!-- Kirjoitetaan funktio poke(), jota kutsutaan kun painetaan hae-painiketta -->
    
    <script>
      function poke() {
        //Tallennetaan annettu Poken nimi muuttujaan pokeName, muuttetaan se samalla pieniksi kirjaimiksi
        const pokeName = document.getElementById("pokemonName").value.toLowerCase();

        //Tallennetaan myös nimi talteen muuttujaan name
        let name = document.getElementById("pokemonName").value;

        //Haetaan kirjoitettu pokemon
        fetch(`https://pokeapi.co/api/v2/pokemon/${pokeName}`)

        //Muunnetaan vastaus JSON-muotoon
        .then(function (response) {
          return response.json();
        })

        //Käsitellään muunnettu (eli JSON muotoinen) vastaus
        //Kutsutaan funktiota kerro() ja välitetään sille json-vastaus
        .then(function (responseJson) {
          pokekuva(responseJson);
        })

        //Jos tuli jokin virhe
        .catch(function (error) {
          document.getElementById("nimi").innerHTML = "<p>Tietoa ei pystytä hakemaan</p>";
        })
        //Määritellään funktio pokekuva(obj)
        function pokekuva(obj) {

          //Tallennetaan muuttujan linkki josta löytty Poken kuva
            let pokeurl = obj.sprites.front_default;

          //Kirjoitetaan kuva, ja nimi sivulla sekä tyhyjennetään hakukenttä
            document.getElementById("kuva2").innerHTML = "<img id='pokepic' src=" + pokeurl + ">";
            document.getElementById("nimi").innerHTML = name;

            //Lisätään käännä-painikkeen ilmestyminen
            document.getElementById("käännä-painike").innerHTML = "<button onclick='kaanna()'>Käännä</button>"

            //Lisätään tieto pituudesta
            document.getElementById("omi1").innerHTML = "<b>Height: </b>" + obj.height;

            //Lisätään tieto id-numerosta
            document.getElementById("omi2").innerHTML = "<b>ID: </b>" + obj.id;

            //Lisätään tieto painosta
            document.getElementById("omi3").innerHTML = "<b>Weight: </b>" + obj.weight;
        }
      }

    //tehdään käännä-funktio, jolla pokemon kääntyy selin
    function kaanna() {

      //HAetaan pokemonin nimi
      const pokeName = document.getElementById("pokemonName").value.toLowerCase();
      
      //Tallennetaan myös nimi talteen muuttujaan name
      let name = document.getElementById("pokemonName").value;

      //Haetaan kirjoitettu pokemon
        fetch(`https://pokeapi.co/api/v2/pokemon/${pokeName}`)

      //Muunnetaan vastaus JSON-muotoon
        .then(function (response) {
          return response.json();
        })

        //Käsitellään muunnettu (eli JSON muotoinen) vastaus
        //Kutsutaan funktiota ja välitetään sille json-vastaus
        .then(function (responseJson) {
          pokekuva(responseJson);
        })

        //Määritellään funktio pokekuva(obj)
          function pokekuva(obj) {

        //Tallennetaan muuttujan linkki josta löytty Poken kuva
           let pokeurl = obj.sprites.back_default;

        //korvataan edellinen kuva uudella ja tyhjennetään hakukenttä
            document.getElementById("kuva2").innerHTML = "<img src=" + pokeurl + ">";
            document.getElementById("pokemonName").value = "";
      }
    }
    </script>
  </body>
</html>