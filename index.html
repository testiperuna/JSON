<!DOCTYPE html>
<html lang="fi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <!-- Bootstrap CSS linkki -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- JS linkki -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <title>JSON palautus</title>
  </head>

  <style>
    img {
      width: 100%;
    }
  </style>

  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-sm navbar-custom">
      <div class="container-fluid">
        <!-- Hamburger -->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#collapsibleNavbar"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="collapsibleNavbar">
          <!-- Links -->
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="./index.html">Etusivu</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./toteutus.html">Toteutus</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="./pokehaku.html">Pokehaku</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <main>
      <div id="vastaus"></div>

      <script>
        // Haetaan tiedot json-tiedostosta
        fetch("tanjis.json")
          //Sitten muunnetaan vastaus oliomuotoon
          .then(function (response) {
            return response.json();
          })

          //Käsitellään muunnettu vastaus ja kutsutaan funktiota kerro() ja välitetään sille json-vastaus
          .then(function (responseJson) {
            kerro(responseJson);
          })

          //Jos hakemisessa tuli virhe, kerrotaan siitä sivulla
          .catch(function (error) {
            document.getElementById("vastaus").innerHTML =
              "<p>Tietoa ei pystytä hakemaan</p>";
          });

        //funktio, joka hakee tiedon objektista ja kirjoittaa ne sivulle

        function kerro(obj) {
          let tiedot =
            "<h1>" +
            //Lisätään otsikko
            obj.otsikko +
            "</h1><br>" +
            obj.kuvaus +
            "<br><hr>" +
            //kuvan määritys
            "<p><img src=" +
            obj.kuva +
            "></p>" +
            //seuraava osuus
            "<center><h3>" +
            "Opintojakso" +
            "</h3>" +
            "Nimi: " +
            obj.opintojakso.nimi +
            "<br>" +
            "Tunnus: " +
            obj.opintojakso.tunnus +
            "<br>" +
            "Opintopisteet: " +
            obj.opintojakso.opintopisteet +
            "<br></center>";

          tiedot += "<p><h3> Aiheet </h3>";

          //Linkit sivulle
          for (var i = 0; i < obj.tekniikat.length; i++) {
            tiedot += "<b>Aihe: " + obj.tekniikat[i].aihe + "</b>";
            tiedot +=
              " <a href=" +
              obj.tekniikat[i].linkki +
              ">" +
              obj.tekniikat[i].linkki +
              "</a>" +
              "<br>";
          }
          tiedot += "</p>";

          //TUlostetaan tiedot sivulle
          document.getElementById("vastaus").innerHTML = tiedot;
        }
      </script>
    </main>
  </body>
</html>
